<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lao Lottery Cloud - Pro Statistics</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0f172a; color: #e5e7eb; margin: 0; padding: 20px; }
        .card { max-width: 700px; margin: auto; background: #1e293b; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h1 { text-align: center; color: #38bdf8; }
        .status-badge { background: #334155; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem; display: inline-block; margin-bottom: 20px; }
        textarea { width: 100%; height: 100px; background: #0f172a; border: 1px solid #334155; color: #38bdf8; padding: 10px; border-radius: 10px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; margin-top: 10px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-import { background: #22c55e; color: #052e16; }
        .btn-gen { background: #38bdf8; color: #082f49; font-size: 1.1rem; margin-bottom: 20px; }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ */
        .hot-container { background: #0f172a; padding: 15px; border-radius: 15px; margin-top: 20px; border: 1px dashed #38bdf8; }
        .hot-title { font-size: 0.9rem; color: #fbbf24; margin-bottom: 10px; text-transform: uppercase; font-weight: bold; }
        .hot-grid { display: flex; justify-content: space-around; gap: 10px; }
        .hot-item { text-align: center; background: #1e293b; padding: 10px; border-radius: 10px; flex: 1; border: 1px solid #334155; }
        .hot-num { display: block; font-size: 1.2rem; color: #38bdf8; font-weight: bold; }
        .hot-count { font-size: 0.7rem; color: #94a3b8; }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(65px, 1fr)); gap: 10px; margin-top: 25px; }
        .num-item { background: #334155; padding: 12px 5px; text-align: center; border-radius: 8px; font-weight: bold; border-bottom: 3px solid #38bdf8; }
    </style>
</head>
<body>

<div class="card">
    <h1>üéØ Lao Lottery Cloud</h1>
    <div style="text-align:center">
        <div class="status-badge" id="data-status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</div>
    </div>

    <div class="hot-container" id="hot-section" style="display:none;">
        <div class="hot-title">üî• 5 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÄ‡∏•‡∏Ç‡∏≠‡∏≠‡∏Å‡∏ö‡πà‡∏≠‡∏¢ (Top 5 Hot)</div>
        <div class="hot-grid" id="hot-list"></div>
    </div>

    <label style="display:block; margin-top:20px;">üì• ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ß‡∏≤‡∏á‡πÄ‡∏•‡∏Ç 3 ‡∏ï‡∏±‡∏ß)</label>
    <textarea id="bulkInput" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 085 123 456..."></textarea>
    <button class="btn-import" onclick="importToCloud()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö Cloud</button>

    <hr style="border:0; border-top:1px solid #334155; margin:30px 0;">

    <button class="btn-gen" onclick="generateSmart()">‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡πá‡∏î 100 ‡∏ä‡∏∏‡∏î</button>
    <div id="result" class="grid"></div>
</div>

<script>
    // Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyBSBP6thMiBi9Jnz663XiWBzDnVgcwTZ0Y",
        authDomain: "lao-lottery-app.firebaseapp.com",
        databaseURL: "https://lao-lottery-app-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "lao-lottery-app",
        storageBucket: "lao-lottery-app.firebasestorage.app",
        messagingSenderId: "5669085764",
        appId: "1:5669085764:web:6b79b5bc41cc0ae7151211",
        measurementId: "G-4VXM6R9C43"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ‡∏ü‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Top 5 ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
    db.ref('history').on('value', (snapshot) => {
        const data = snapshot.val();
        if (!data) return;

        const historyArray = Object.values(data).map(item => item.number);
        document.getElementById('data-status').innerHTML = `üü¢ Cloud Online: <b>${historyArray.length}</b> ‡∏á‡∏ß‡∏î`;
        
        calculateTop5(historyArray);
    });

    function calculateTop5(numbers) {
        const counts = {};
        numbers.forEach(num => counts[num] = (counts[num] || 0) + 1);

        // ‡∏à‡∏±‡∏î‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡πÅ‡∏Ñ‡πà Top 5
        const sorted = Object.entries(counts)
            .sort((a, b) => b[1] - a[1])
            .slice(0, 5);

        if (sorted.length > 0) {
            document.getElementById('hot-section').style.display = 'block';
            const hotList = document.getElementById('hot-list');
            hotList.innerHTML = sorted.map(([num, count]) => `
                <div class="hot-item">
                    <span class="hot-num">${num}</span>
                    <span class="hot-count">‡∏≠‡∏≠‡∏Å ${count} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>
                </div>
            `).join('');
        }
    }

    function importToCloud() {
        const text = document.getElementById('bulkInput').value;
        const found = text.match(/\d{3}/g);
        if (!found) return alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏•‡∏Ç 3 ‡∏´‡∏•‡∏±‡∏Å");

        found.forEach(num => {
            db.ref('history').push({ number: num, createdAt: firebase.database.ServerValue.TIMESTAMP });
        });
        document.getElementById('bulkInput').value = "";
    }

    async function generateSmart() {
        const snapshot = await db.ref('history').limitToLast(100).once('value');
        const historyData = [];
        snapshot.forEach(child => { historyData.push(child.val().number); });

        const pool = new Set();
        while (pool.size < 100) {
            const n = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            if (n[0] === n[1] && n[1] === n[2]) continue;
            if (historyData.includes(n) && Math.random() > 0.1) continue;
            pool.add(n);
        }
        document.getElementById('result
